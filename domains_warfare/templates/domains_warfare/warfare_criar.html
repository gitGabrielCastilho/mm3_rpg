{% extends 'base.html' %}

{% block content %}
<div class="combate-center">
  <h2 class="combate-title">Iniciar Combate Warfare</h2>
  <div class="combate-card">
    <form method="post" class="combate-form-selecao">
      {% csrf_token %}
      
      <div class="form-group" style="margin-bottom: 1.5rem;">
        <label for="nome" style="display: block; margin-bottom: 0.5rem; color: var(--gold); font-weight: bold;">Nome do Combate:</label>
        <input type="text" id="nome" name="nome" value="Batalha de Warfare" class="form-control" style="width:100%; max-width: 420px; padding: 8px 10px; border: 1px solid #666; border-radius: 4px; background:#1e1e1e; color:#fff;">
      </div>

      <div class="busca-wrap" style="margin-bottom: 0.8rem;">
        <input type="text" id="busca-domain" class="busca-input" placeholder="Buscar domain..." style="width:100%; max-width: 420px; padding: 8px 10px; border: 1px solid #666; border-radius: 4px; background:#1e1e1e; color:#fff;">
      </div>
      
      <div class="domains-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
        {% for domain in domains %}
          <label class="domain-check" style="display: flex; align-items: center; padding: 1rem; background: var(--card-bg); border: 1px solid #3a3a3a; border-radius: 6px; cursor: pointer; transition: all 0.2s;">
            <input type="checkbox" name="domains" value="{{ domain.id }}" style="margin-right: 0.75rem; width: 18px; height: 18px;">
            <div style="flex: 1;">
              <div class="domain-nome" style="font-weight: 600; color: var(--gold); margin-bottom: 0.25rem;">{{ domain.nome }}</div>
              <div class="domain-info" style="font-size: 0.85rem; color: var(--text-muted);">
                <div>Nível {{ domain.nivel }}</div>
                <div>{{ domain.units.count }} unidade{{ domain.units.count|pluralize }}</div>
              </div>
            </div>
          </label>
        {% empty %}
          <p style="grid-column: 1 / -1; text-align: center; color: var(--text-muted); padding: 2rem;"><em>Nenhum domain disponível.</em></p>
        {% endfor %}
      </div>
      
      <div class="combate-form-acoes" style="display: flex; gap: 0.75rem; justify-content: flex-end;">
        <a href="{% url 'warfare_listar' %}" class="btn btn-secondary" style="padding: 0.75rem 1.5rem; background: #555; color: white; text-decoration: none; border-radius: 4px;">Cancelar</a>
        <button type="submit" class="btn" style="padding: 0.75rem 1.5rem; background: var(--accent); color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: 600;">Iniciar Combate</button>
      </div>
    </form>
  </div>
</div>

<style>
  .combate-center {
    max-width: 900px;
    margin: 2rem auto;
    padding: 0 1rem;
  }
  
  .combate-title {
    color: var(--gold);
    margin-bottom: 1.5rem;
    text-align: center;
  }
  
  .combate-card {
    background: var(--card-bg);
    border: 1px solid var(--gold);
    border-radius: 8px;
    padding: 2rem;
  }
  
  .domain-check:hover {
    border-color: var(--gold);
    background: #2d2d2d;
  }
  
  .domain-check input:checked + div .domain-nome {
    color: #4a90e2;
  }
  
  .btn:hover {
    opacity: 0.9;
  }
  
  .btn-secondary:hover {
    background: #666;
  }
</style>

<script>
document.addEventListener('DOMContentLoaded', function(){
  const busca = document.getElementById('busca-domain');
  const labels = Array.from(document.querySelectorAll('.domains-grid .domain-check'));
  
  function filtrar(){
    const termo = (busca.value || '').toLowerCase();
    labels.forEach(lb => {
      const texto = lb.textContent.toLowerCase();
      lb.style.display = !termo || texto.includes(termo) ? '' : 'none';
    });
  }
  
  if (busca) {
    busca.addEventListener('input', filtrar);
  }
  
  filtrar();
});
</script>
{% endblock %}
