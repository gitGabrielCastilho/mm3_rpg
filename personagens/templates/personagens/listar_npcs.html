{% extends 'base.html' %}
{% block content %}
<div class="personagens-center">
  <h1 class="personagens-title">Meus NPCs</h1>
  <div class="busca-wrap" style="margin-bottom: 12px;">
    <input id="busca-npcs" type="text" placeholder="Buscar NPC..." style="width:100%; max-width:420px; padding:8px 10px; border:1px solid #666; border-radius:4px; background:#1e1e1e; color:#fff;">
  </div>
  <ul class="personagens-list npcs-inline">
    {% for npc in npcs %}
      <li class="npc-item">
        <div class="npc-info">
          <span class="personagem-link">{{ npc.nome }}</span>
          <span class="personagem-np">(NP {{ npc.nivel_poder|default:"?" }})</span>
        </div>
        <div class="npc-actions">
          <a href="{% url 'editar_npc' npc.id %}">
            <button type="button" class="btn btn-sm">Editar</button>
          </a>
          <a href="{% url 'excluir_npc' npc.id %}">
            <button type="button" class="btn btn-excluir btn-sm">Excluir</button>
          </a>
        </div>
      </li>
    {% empty %}
      <p>Você ainda não criou nenhum NPC.</p>
    {% endfor %}
  </ul>
</div>
  <script>
  document.addEventListener('DOMContentLoaded', function(){
    const busca = document.getElementById('busca-npcs');
    const itens = Array.from(document.querySelectorAll('.personagens-list.npcs-inline > li'));
    function filtrar(){
      const termo = (busca.value || '').toLowerCase();
      itens.forEach(li => {
        const texto = li.textContent.toLowerCase();
        li.style.display = !termo || texto.includes(termo) ? '' : 'none';
      });
    }
    if (busca) {
      busca.addEventListener('input', filtrar);
    }
    filtrar();
  });
  </script>
{% endblock %}
